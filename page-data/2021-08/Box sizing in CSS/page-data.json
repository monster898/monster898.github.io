{"componentChunkName":"component---src-templates-blog-post-js","path":"/2021-08/Box sizing in CSS/","result":{"data":{"site":{"siteMetadata":{"title":"好成的blog"}},"markdownRemark":{"id":"b72a5eec-3d5c-5906-9c32-a0c8ba415091","excerpt":"Box sizing in CSS 在这篇文章中，我会讲清楚在特定的定位方案下(positioning scheme)，盒子是如何被 HTML 生成的。CSS 盒模型定义了盒子组件的基本结构。 盒子的大小是跟盒模型有关的，但是很大程度上也受使用的定位方案影响。一些 CSS 教程在介绍定位方案之前就讲 CSS…","html":"<h1>Box sizing in CSS</h1>\n<p>在这篇文章中，我会讲清楚在特定的定位方案下(positioning scheme)，盒子是如何被 HTML 生成的。CSS 盒模型定义了盒子组件的基本结构。</p>\n<p>盒子的大小是跟盒模型有关的，但是很大程度上也受使用的定位方案影响。一些 CSS 教程在介绍定位方案之前就讲 CSS 盒模型，但我会调换下顺序，因为你无法真正的理解盒子模型的 margins 和 content 的大小是如何计算出来的除非你能在定位方案背景下看待盒子。</p>\n<h2>Content dimensions and margins</h2>\n<p>padding 和 border 属性作用几乎是一致的：在 content box 外生成 padding 和 border。有一个边缘情况，如果内容被分成多行，inline-level 元素(不包括 inline-block)左右的 border 仅绘制一次，而不是为每个 line box 都绘制，上下边框不会影响竖直方向的布局。</p>\n<p>例如：</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blue<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Lorem ipsum dolor sit amet, sed nulla, dignissim suspendisse libero massa erat tempor.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>green<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Lorem ipsum dolor sit amet, sed nulla, dignissim suspendisse libero massa erat tempor.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0070565e498ed75bdc4bcceee8f1b2f5/e185b/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.51898734177215%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAw0lEQVQY053Kv2rCUBiG8Vy0Y+/CHGOM9A6SKFGHaqwV6SC25+TfEayTIi4OgtCURn0k6SCdCv3gN7wfjyEGC+r9OfYooTVKcMaaVpjSnixxwrT628OY5jCm/axpPqlql03JCbPK4+uaXrbH8N8U7kIS6CVBpu+0/r3/EK52yO0Rw549YE5reFLgK0EntvCjBt3UohMJPCXwpIkrBd3Ewn03f9qoUSl7T9U5nDaUZ0w/Al7WPfLii88i/5/vnOJy5nqFG9HKDpST+FocAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/0070565e498ed75bdc4bcceee8f1b2f5/f058b/5.png\"\n        srcset=\"/static/0070565e498ed75bdc4bcceee8f1b2f5/c26ae/5.png 158w,\n/static/0070565e498ed75bdc4bcceee8f1b2f5/6bdcf/5.png 315w,\n/static/0070565e498ed75bdc4bcceee8f1b2f5/f058b/5.png 630w,\n/static/0070565e498ed75bdc4bcceee8f1b2f5/e185b/5.png 691w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>让我们先快速总结一下计算内容尺寸（width 和 height）和自动边距（margin：auto）的机制：根据一个盒子是 inline，block，floated 或者绝对定位而不同，另外，display：in-block 有特殊的行为，下面表格总结了当这些值设定为 auto 时的情况。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/18313b230f23e5c09a97b002569c7172/39048/c1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.202531645569614%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe6lNA//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAYEAEBAQEBAAAAAAAAAAAAAAAAMQFR0f/aAAgBAQABPyFWR14yP//aAAwDAQACAAMAAAAQcA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAwADAAAAAAAAAAAAAAABABExIVFx/9oACAEBAAE/EOwNJVrRyoKBzDPDHYyn/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/18313b230f23e5c09a97b002569c7172/828fb/c1.jpg\"\n        srcset=\"/static/18313b230f23e5c09a97b002569c7172/ff44c/c1.jpg 158w,\n/static/18313b230f23e5c09a97b002569c7172/a6688/c1.jpg 315w,\n/static/18313b230f23e5c09a97b002569c7172/828fb/c1.jpg 630w,\n/static/18313b230f23e5c09a97b002569c7172/39048/c1.jpg 908w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Box model calculations for inline elements</h2>\n<p>inline,不可替换元素是最容易理解的。</p>\n<p>width 和 height 被 inline-level 元素忽略，取决于内容大小(text)。</p>\n<p>行内元素通过将它们放置在 line 内来定位，line box 取决于 font-size 和 line-height。</p>\n<p>margin-top 和 margin-bottom 被 in-line level 元素忽略。</p>\n<p>margin-right 和 margin-left 对 inline box 起作用，在同一 line box 中相对于其他内容水平偏移，设置为 auto 会简单的当成 0 处理，没有特殊的处理。</p>\n<h2>“Content-based” height for blocks, floats and inline-blocks</h2>\n<p>content-based：即定位元素的子元素后，取最后一个子元素的底边，并设置元素的高度匹配。</p>\n<p>实际上有两种计算：</p>\n<ul>\n<li>在 normal flow 中的 floats，inline-block，和 block-level 元素，overflow 属性设置不是 visible。</li>\n<li>在 normal flow 中的 block-level 元素，overflow 为 visible。</li>\n</ul>\n<p>第二种忽略了后代元素中的浮动元素，这也就是为什么默认情况下，只有浮动元素后代的块级框的高度为 0，因为 visible 是 overflow 的默认值。</p>\n<p>第一种情况，overflow 属性设置不是 visible，后代浮动元素的高度也会算入。</p>\n<blockquote>\n<p>In addition, if the element has any floating descendants whose bottom margin edge is below the element’s bottom content edge, then the height is increased to include those edges. Only floats that participate in this block formatting context are taken into account, e.g., floats inside absolutely positioned descendants or other floats are not.</p>\n</blockquote>\n<p>换句话说，默认 width，height 都是 auto，除非指定明确的高度，否则这些块将始终扩展以适应其所有内容。</p>\n<h2>Width calculations</h2>\n<p>Block-level：constraint-based,width 或者 margin 设为 auto，会占据未使用的空间填充，减去任何已明确设置的值并将这个值设置为结果。</p>\n<p>Floating blocks and inline-block：shrink-to-fit，1) 首选宽度（例如，使用尽可能少的换行），2） 可用的首选最小宽度（例如，使用尽可能多的换行）和 3) 可用宽度。</p>\n<p>如果水平空间可用，则宽度值设置为首选宽度，否则设置为首选最小宽度，在最坏的情况下，可用宽度有一些潜在的溢出。</p>\n<h2>Width calculations: block-level elements (constraint-based)</h2>\n<p>margin-left+border-left+padding-left+width+padding-right+border-right+margin-right =width of containing block</p>\n<p>border 和 padding 不能设置为 auto，简化为 margin-left+width+margin-right = width of containing block</p>\n<p>三种情况：</p>\n<ul>\n<li>margin 和 width 都设为 auto</li>\n<li>width 设定为具体的值，margin 为 auto</li>\n<li>三个中的两个设定为具体的值，另一个设置为 auto</li>\n</ul>\n<p>第一种情况宽度优先，margin 会自动为 0，宽度会占据一行中所有未使用的空间</p>\n<p>第二种情况，会居中此元素，即左右 margin 平分可用的空间</p>\n<p>第三种情况会满足设定的具体值，剩下的就是 auto 的值，满足上面公式即可。</p>\n<h2>Width calculations: floating blocks and inline-block elements (shrink-to-fit)</h2>\n<blockquote>\n<p>If ‘width’ is computed as ‘auto’, the used value is the “shrink-to-fit” width.\r\nCalculation of the shrink-to-fit width is similar to calculating the width of a table cell using the automatic table layout algorithm. Roughly: calculate the preferred width by formatting the content without breaking lines other than where explicit line breaks occur, and also calculate the preferred minimum width, e.g., by trying all possible line breaks. CSS 2.1 does not define the exact algorithm. Thirdly, find the available width: in this case, this is the width of the containing block minus the used values of ‘margin-left’, ‘border-left-width’, ‘padding-left’, ‘padding-right’, ‘border-right-width’, ‘margin-right’, and the widths of any relevant scroll bars.\r\nThen the shrink-to-fit width is: min(max(preferred minimum width, available width), preferred width).</p>\n</blockquote>\n<p>1.当有很多空间可用，width 为首选宽度(preferred width)(尽可能少的分为多行)</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">.</span>inline<span class=\"token operator\">-</span>block <span class=\"token punctuation\">{</span>\r\n  display<span class=\"token operator\">:</span> inline<span class=\"token operator\">-</span>block<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>big blue<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>inline-block orange<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">AAAAAAAAA BBBBB</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5ae7280d1d4329f99d8d913e798c66a6/d67ca/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.860759493670885%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAXElEQVQI143DwQmAIAAF0IYuqJZRvFRDZB46pEQJRWcttaPRAj9oAh+8TLU1pqaEbCoImqMnBbpxAZ09mDJgyiYn0iALh0A4hv+1c5wbx25vrP6FdhHaPcnXK+IDOSuHlcdY+fEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/5ae7280d1d4329f99d8d913e798c66a6/f058b/1.png\"\n        srcset=\"/static/5ae7280d1d4329f99d8d913e798c66a6/c26ae/1.png 158w,\n/static/5ae7280d1d4329f99d8d913e798c66a6/6bdcf/1.png 315w,\n/static/5ae7280d1d4329f99d8d913e798c66a6/f058b/1.png 630w,\n/static/5ae7280d1d4329f99d8d913e798c66a6/d67ca/1.png 714w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>2.当可用空间小于首选宽度，大于首选最小宽度(尽可能多的分行),用此可用空间</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">.</span>big <span class=\"token punctuation\">{</span>\r\n  width<span class=\"token operator\">:</span> <span class=\"token number\">130</span>px<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">.</span>inline<span class=\"token operator\">-</span>block <span class=\"token punctuation\">{</span>\r\n  display<span class=\"token operator\">:</span> inline<span class=\"token operator\">-</span>block<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>big blue<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>inline-block orange<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">AAAAAAAAA BBBBB</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 443px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e302a7167cbe9c6b4a814b413ead4b96/a120c/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.354430379746837%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAo0lEQVQY05XMuw7BAACFYS8nsbp0sbN4AovRyGIUactscCshpS6xGFp1iWgZiFmiCNL+wmDWPzk52xeYdYostTLmQMZQJeZ9CV2VWWkixrTB4+XyyfM8/ilgFoLYYoxtKcxeinKoCOzEGG4zzqmVxrk9/IH1bIheTqCbj3CsJri0U5yVFFclybqWwbk//YFrfYi9mGCZ4+//Zo6wNgYv1/MFvgHG0SINVPhyAwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/e302a7167cbe9c6b4a814b413ead4b96/a120c/2.png\"\n        srcset=\"/static/e302a7167cbe9c6b4a814b413ead4b96/c26ae/2.png 158w,\n/static/e302a7167cbe9c6b4a814b413ead4b96/6bdcf/2.png 315w,\n/static/e302a7167cbe9c6b4a814b413ead4b96/a120c/2.png 443w\"\n        sizes=\"(max-width: 443px) 100vw, 443px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>3.当可用空间小于首选最小宽度，可能会发生溢出</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">.</span>big <span class=\"token punctuation\">{</span>\r\n  width<span class=\"token operator\">:</span> <span class=\"token number\">80</span>px<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">.</span>inline<span class=\"token operator\">-</span>block <span class=\"token punctuation\">{</span>\r\n  display<span class=\"token operator\">:</span> inline<span class=\"token operator\">-</span>block<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>big blue<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>inline-block orange<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">AAAAAAAAA BBBBB</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 614px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b4c075bf947d4995dcf4a3a94a6c68ff/e9131/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.39240506329114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQklEQVQI12M4t7nn/4X5Cf+vLM/+f3tF6v83B3v/g8C/f//AmFTAcGH71P9nFmb9v7e56v/3g7X//16a9/8fBQYCADfllfb+6dvDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/b4c075bf947d4995dcf4a3a94a6c68ff/e9131/3.png\"\n        srcset=\"/static/b4c075bf947d4995dcf4a3a94a6c68ff/c26ae/3.png 158w,\n/static/b4c075bf947d4995dcf4a3a94a6c68ff/6bdcf/3.png 315w,\n/static/b4c075bf947d4995dcf4a3a94a6c68ff/e9131/3.png 614w\"\n        sizes=\"(max-width: 614px) 100vw, 614px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Margins for floating blocks and inline-block elements</h2>\n<p>很简单，设为 0。</p>\n<h2>Absolutely positioned, non-replaced elements</h2>\n<p>混合了 constraint-based 和 shrink-to-fit or content-based 算法。</p>\n<p>constraint-based：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">'top' + 'margin-top' + 'border-top-width' + 'padding-top' +\r\n'height' + 'padding-bottom' + 'border-bottom-width' +\r\n'margin-bottom' + 'bottom'\r\n= heightof containing block</code></pre></div>\n<p>and</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">'left' + 'margin-left' + 'border-left-width' + 'padding-left' +\r\n'width' + 'padding-right' + 'border-right-width' + 'margin-right' +\r\n'right'\r\n= widthof containing block</code></pre></div>\n<p>因为 border 和 padding 的值不能设为 auto，所以可以简化为</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">'top' + 'margin-top' + 'height' + 'margin-bottom' + 'bottom'\r\n= height of containing block</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">'left' + 'margin-left' + 'width' + 'margin-right' + 'right'\r\n= width of containing block</code></pre></div>\n<p>内容+偏移量+margin = 包含块的大小</p>\n<p>(width + the left &#x26; right margins + left &#x26; right offsets, or height + the top &#x26; bottom margins + top &#x26; bottom offsets)</p>\n<p>有以下几种情况</p>\n<ul>\n<li>\n<p>如果所有的属性都设置了具体的值，就使用这些值。</p>\n</li>\n<li>\n<p>如果 width/height 和 offsets 设置了具体的值,margin 为 auto 时，两边 margin 平分剩余的空间，当两边 offsets 值相等，可以居中元素。</p>\n</li>\n<li>\n<p>如果 width/height 和 offsets 设置了具体的值,一个 margin 设置了值一个为 auto，则根据上面的公式计算出值作为 auto 的值。</p>\n</li>\n<li>\n<p>否则，margin 为 auto 当作 0 看待，看剩下三个属性(width + offsets or height + offsets)</p>\n<ul>\n<li>如果这些属性都没有设置为 auto，上面已经处理过这种情况，因为这些值都是显式设置的。</li>\n<li>如果三个中只有一个设置为 auto，通过 constraint-based 算法计算缺失的值。</li>\n<li>如果两个属性设置为 auto 并且其中一个属性是 width/height，则使用的 shrink-to-fit or content-based 方法来计算 width/height，然后使用基于 constraint-based 的方法来计算另一个缺失值。</li>\n<li>如果这三个属性都是 auto 的，定位元素，就像它静态定位在顶部或左侧一样，然后使用 shrink-to-fit（for width）/content-based（for height）来计算内容大小，然后使用 constraint-based 来计算 bottom/right 的尺寸。</li>\n<li>当 width/height 设置了具体值，offsets 为 auto 时，并不会居中，位置同上，不会改变元素位置。</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/599b38a6b125f524a12301d95e75bc55/1568e/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.15189873417721%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxUlEQVQ4y62SXW7TQBSFvQra1PbM+Hfsie2xU5KmQYKtoMIjQuwPHhCriFUkxCbgxdWHZhooTZ0nsHRkyx5/95x7b7Bav+Ry/QI7XKFSzdl5zOJCep0vInTdY4cd66tXNHbL0Fe8e13y/qbmw5uaoUt4diboVztae01QVj1KpXRNTdfWmGZJ1TRoYxAyJYqVhyZpTVGWbDeW7WbALCu6tiQvCi5Cia4trd0SFLrzP1Vao1RGLFJimd7fRUoYKcrKevdSZixNz1IvsUZTm4osL1lcCCpjafstQaktYSQJ44ToSA7oijlgklZImdN3G6xp2TUalWjSND+kOAL+dhTFD+6OgUKkNKanbTqMacizCmNqYpEcgNdzwOQkUKqcxqzobcPzy5YwSnwy18PqlMNj/Q1USeELelD0UNgDTU835/AU0A3FDejxt+TP4NLMbcjarY09HMxOABPcajmHx+14JJmh64GgLFvCUPjGPpmyjyfRHqjvk8xsg0shZEZlVgTZsCNSGiFL4jmJgrx0kY1/jk+cE0pT6J5gf/OW8fMXxm/fGfe3jOPXJ9qPt+xn3s+dC/j0EX7+4H9dwQR4TRPT3R3T9G/6BeJbHOWD4D0TAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/599b38a6b125f524a12301d95e75bc55/f058b/4.png\"\n        srcset=\"/static/599b38a6b125f524a12301d95e75bc55/c26ae/4.png 158w,\n/static/599b38a6b125f524a12301d95e75bc55/6bdcf/4.png 315w,\n/static/599b38a6b125f524a12301d95e75bc55/f058b/4.png 630w,\n/static/599b38a6b125f524a12301d95e75bc55/1568e/4.png 892w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n</li>\n</ul>\n<p>正如你所看到的，经验法则是，如果内容尺寸没有被指定，那么在试图通过盒子模型指定 constraint-based 的算法来填充其余的值之前，会使用 shrink-to-fit（for width）/content-based（for height）的算法来计算它们。</p>\n<p>使用绝对定位可以水平或者竖直定位元素，但有两点警告：</p>\n<ul>\n<li>绝对定位的元素不与后面的同级元素交互，并且可以绘制在正常流中的任何内容之上。</li>\n<li>为了去触发 margin 为 auto 居中的效果，内容大小(width / height)和 偏移量(left / right / top / bottom) 必须设置。这个很重要，可以通过设置内容大小百分比或者 max-width 或者 min-width 优化。</li>\n</ul>","frontmatter":{"title":"Box sizing in CSS","date":"August 14, 2021","description":"学习CSS布局(2)"},"timeToRead":7},"previous":{"fields":{"slug":"/2021-08/浏览器渲染原理/"},"frontmatter":{"title":"理解浏览器渲染原理"}},"next":{"fields":{"slug":"/2021-08/Additional-properties-that-influence-positioning/"},"frontmatter":{"title":"Additional properties that influence positioning"}}},"pageContext":{"id":"b72a5eec-3d5c-5906-9c32-a0c8ba415091","previousPostId":"3c79dfaf-83ab-5475-8eb2-26e85475712e","nextPostId":"f715fd2a-f251-5258-ac24-ec00fb9811fa"}},"staticQueryHashes":["2841359383","3415673938"]}